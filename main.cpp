#include <systemc.h>
#include <bits/stdc++.h>
#include <map>
#include <bitset>
#include<unistd.h>
#include "roteador.h"

int sc_main(int argc, char* argv[]){
    sc_signal<bool> clk;
    clk.write(true);
    sc_signal<sc_bv<34>>1to2 = "0000000000000000000000000000000000";
    sc_signal<bool>val1to2 = false;
    sc_signal<bool>ack1to2 = false;
    sc_signal<sc_bv<34>>1to5 = "0000000000000000000000000000000000";
    sc_signal<bool>val1to5 = false;
    sc_signal<bool>ack1to5 = false;
    sc_signal<sc_bv<34>>1to8 = "0000000000000000000000000000000000";
    sc_signal<bool>val1to8 = false;
    sc_signal<bool>ack1to8 = false;
    sc_signal<sc_bv<34>>2to1 = "0000000000000000000000000000000000";
    sc_signal<bool>val2to1 = false;
    sc_signal<bool>ack2to1 = false;
    sc_signal<sc_bv<34>>2to3 = "0000000000000000000000000000000000";
    sc_signal<bool>val2to3 = false;
    sc_signal<bool>ack2to3 = false;
    sc_signal<sc_bv<34>>2to6 = "0000000000000000000000000000000000";
    sc_signal<bool>val2to6 = false;
    sc_signal<bool>ack2to6 = false;
    sc_signal<sc_bv<34>>3to2 = "0000000000000000000000000000000000";
    sc_signal<bool>val3to2 = false;
    sc_signal<bool>ack3to2 = false;
    sc_signal<sc_bv<34>>3to4 = "0000000000000000000000000000000000";
    sc_signal<bool>val3to4 = false;
    sc_signal<bool>ack3to4 = false;
    sc_signal<sc_bv<34>>3to7 = "0000000000000000000000000000000000";
    sc_signal<bool>val3to7 = false;
    sc_signal<bool>ack3to7 = false;
    sc_signal<sc_bv<34>>4to3 = "0000000000000000000000000000000000";
    sc_signal<bool>val4to3 = false;
    sc_signal<bool>ack4to3 = false;
    sc_signal<sc_bv<34>>4to5 = "0000000000000000000000000000000000";
    sc_signal<bool>val4to5 = false;
    sc_signal<bool>ack4to5 = false;
    sc_signal<sc_bv<34>>4to8 = "0000000000000000000000000000000000";
    sc_signal<bool>val4to8 = false;
    sc_signal<bool>ack4to8 = false;
    sc_signal<sc_bv<34>>5to1 = "0000000000000000000000000000000000";
    sc_signal<bool>val5to1 = false;
    sc_signal<bool>ack5to1 = false;
    sc_signal<sc_bv<34>>5to4 = "0000000000000000000000000000000000";
    sc_signal<bool>val5to4 = false;
    sc_signal<bool>ack5to4 = false;
    sc_signal<sc_bv<34>>5to6 = "0000000000000000000000000000000000";
    sc_signal<bool>val5to6 = false;
    sc_signal<bool>ack5to6 = false;
    sc_signal<sc_bv<34>>6to2 = "0000000000000000000000000000000000";
    sc_signal<bool>val6to2 = false;
    sc_signal<bool>ack6to2 = false;
    sc_signal<sc_bv<34>>6to5 = "0000000000000000000000000000000000";
    sc_signal<bool>val6to5 = false;
    sc_signal<bool>ack6to5 = false;
    sc_signal<sc_bv<34>>6to7 = "0000000000000000000000000000000000";
    sc_signal<bool>val6to7 = false;
    sc_signal<bool>ack6to7 = false;
    sc_signal<sc_bv<34>>7to3 = "0000000000000000000000000000000000";
    sc_signal<bool>val7to3 = false;
    sc_signal<bool>ack7to3 = false;
    sc_signal<sc_bv<34>>7to6 = "0000000000000000000000000000000000";
    sc_signal<bool>val7to6 = false;
    sc_signal<bool>ack7to6 = false;
    sc_signal<sc_bv<34>>7to8 = "0000000000000000000000000000000000";
    sc_signal<bool>val7to8 = false;
    sc_signal<bool>ack7to8 = false;
    sc_signal<sc_bv<34>>8to1 = "0000000000000000000000000000000000";
    sc_signal<bool>val8to1 = false;
    sc_signal<bool>ack8to1 = false;
    sc_signal<sc_bv<34>>8to4 = "0000000000000000000000000000000000";
    sc_signal<bool>val8to4 = false;
    sc_signal<bool>ack8to4 = false;
    sc_signal<sc_bv<34>>8to7 = "0000000000000000000000000000000000";
    sc_signal<bool>val8to7 = false;
    sc_signal<bool>ack8to7 = false;


    if (argc != 2) {
        std::cout << "Uso: " << argv[0] << " <caminho_para_arquivo>" << std::endl;
        return 1;
    }
    const std::string filePath = argv[1];
    std::ifstream file(filePath);
    if (!file) {
        std::cout << "Não foi possível abrir o arquivo: " << filePath << std::endl;
        return 1;
    }
    std::string line;
    int count = 0;
    sc_signal<sc_bv<34>> locals_data[8];
    sc_signal<sc_bv<34>> locals_val[8];
    locals_val[0].write(false);
    locals_val[1].write(false);
    locals_val[2].write(false);
    locals_val[3].write(false);
    locals_val[4].write(false);
    locals_val[5].write(false);
    locals_val[6].write(false);
    locals_val[7].write(false);
    sc_signal<sc_bv<34>> locals_ack[8];
    locals_ack[0].write(false);
    locals_ack[1].write(false);
    locals_ack[2].write(false);
    locals_ack[3].write(false);
    locals_ack[4].write(false);
    locals_ack[5].write(false);
    locals_ack[6].write(false);
    locals_ack[7].write(false);

    sc_signal<sc_bv<34>> out_locals_data[8];
    sc_signal<sc_bv<34>> out_locals_val[8];
    out_locals_val[0].write(false);
    out_locals_val[1].write(false);
    out_locals_val[2].write(false);
    out_locals_val[3].write(false);
    out_locals_val[4].write(false);
    out_locals_val[5].write(false);
    out_locals_val[6].write(false);
    out_locals_val[7].write(false);
    sc_signal<sc_bv<34>> out_locals_ack[8];
    out_locals_ack[0].write(false);
    out_locals_ack[1].write(false);
    out_locals_ack[2].write(false);
    out_locals_ack[3].write(false);
    out_locals_ack[4].write(false);
    out_locals_ack[5].write(false);
    out_locals_ack[6].write(false);
    out_locals_ack[7].write(false);
    while (std::getline(file, line) && count < 8) {
        locals[count].write(line);
        count++;                
    }
    roteador r1("r1");
    r1.in_dataL(locals_data[0]);
    r1.in_valL(locals_val[0]);
    r1.in_ackL(locals_ack[0]);
    r1.in_dataA(2to1);
    r1.in_valA(val2to1);
    r1.in_ackA(ack2to1);
    r1.in_dataH(8to1);
    r1.in_valH(val8to1);
    r1.in_ackH(ack8to1);
    r1.in_dataT(5to1);
    r1.in_valT(val5to1);
    r1.in_ackT(ack5to1);
    r1.out_dataL(out_locals_data[0]);
    r1.out_valL(out_locals_val[0]);
    r1.out_ackL(out_locals_ack[0]);
    r1.out_dataA(1to8);
    r1.out_valA(val1to8);
    r1.out_ackA(ack1to8);
    r1.out_dataH(1to2);
    r1.out_valH(val1to2);
    r1.out_ackH(ack1to2);
    r1.out_dataT(1to5);
    r1.out_valT(val1to5);
    r1.out_ackT(ack1to5);

    roteador r2("r2");
    r1.in_dataL(locals_data[1]);
    r1.in_valL(locals_val[1]);
    r1.in_ackL(locals_ack[1]);
    r1.in_dataA(3to2);
    r1.in_valA(val3to2);
    r1.in_ackA(ack3to2);
    r1.in_dataH(1to2);
    r1.in_valH(val1to2);
    r1.in_ackH(ack1to2);
    r1.in_dataT(6to2);
    r1.in_valT(val6to2);
    r1.in_ackT(ack6to2);
    r1.out_dataL(out_locals_data[1]);
    r1.out_valL(out_locals_val[1]);
    r1.out_ackL(out_locals_ack[1]);
    r1.out_dataA(2to1);
    r1.out_valA(val2to1);
    r1.out_ackA(ack2to1);
    r1.out_dataH(2to3);
    r1.out_valH(val2to3);
    r1.out_ackH(ack2to3);
    r1.out_dataT(2to6);
    r1.out_valT(val2to6);
    r1.out_ackT(ack2to6);

    roteador r3("r3");
    r1.in_dataL(locals_data[2]);
    r1.in_valL(locals_val[2]);
    r1.in_ackL(locals_ack[2]);
    r1.in_dataA(4to3);
    r1.in_valA(val4to3);
    r1.in_ackA(ack4to3);
    r1.in_dataH(2to3);
    r1.in_valH(val2to3);
    r1.in_ackH(ack2to3);
    r1.in_dataT(7to3);
    r1.in_valT(val7to3);
    r1.in_ackT(ack7to3);
    r1.out_dataL(out_locals_data[2]);
    r1.out_valL(out_locals_val[2]);
    r1.out_ackL(out_locals_ack[2]);
    r1.out_dataA(3to2);
    r1.out_valA(val3to2);
    r1.out_ackA(ack3to2);
    r1.out_dataH(3to4);
    r1.out_valH(val3to4);
    r1.out_ackH(ack3to4);
    r1.out_dataT(3to7);
    r1.out_valT(val3to7);
    r1.out_ackT(ack3to7);

    roteador r4("r4");
    r1.in_dataL(locals_data[3]);
    r1.in_valL(locals_val[3]);
    r1.in_ackL(locals_ack[3]);
    r1.in_dataA(5to4);
    r1.in_valA(val5to4);
    r1.in_ackA(ack5to4);
    r1.in_dataH(3to4);
    r1.in_valH(val3to4);
    r1.in_ackH(ack3to4);
    r1.in_dataT(8to4);
    r1.in_valT(val8to4);
    r1.in_ackT(ack8to4);
    r1.out_dataL(out_locals_data[3]);
    r1.out_valL(out_locals_val[3]);
    r1.out_ackL(out_locals_ack[3]);
    r1.out_dataA(4to3);
    r1.out_valA(val4to3);
    r1.out_ackA(ack4to3);
    r1.out_dataH(4to5);
    r1.out_valH(val4to5);
    r1.out_ackH(ack4to5);
    r1.out_dataT(4to8);
    r1.out_valT(val4to8);
    r1.out_ackT(ack4to8);

    roteador r5("r5");
    r1.in_dataL(locals_data[4]);
    r1.in_valL(locals_val[4]);
    r1.in_ackL(locals_ack[4]);
    r1.in_dataA(6to5);
    r1.in_valA(val6to5);
    r1.in_ackA(ack6to5);
    r1.in_dataH(4to6);
    r1.in_valH(val4to6);
    r1.in_ackH(ack4to6);
    r1.in_dataT(1to5);
    r1.in_valT(val1to5);
    r1.in_ackT(ack1to5);
    r1.out_dataL(out_locals_data[4]);
    r1.out_valL(out_locals_val[4]);
    r1.out_ackL(out_locals_ack[4]);
    r1.out_dataA(5to4);
    r1.out_valA(val5to4);
    r1.out_ackA(ack5to4);
    r1.out_dataH(5to6);
    r1.out_valH(val5to6);
    r1.out_ackH(ack5to6);
    r1.out_dataT(5to1);
    r1.out_valT(val5to1);
    r1.out_ackT(ack5to1);

    roteador r6("r6");
    r1.in_dataL(locals_data[5]);
    r1.in_valL(locals_val[5]);
    r1.in_ackL(locals_ack[5]);
    r1.in_dataA(7to6);
    r1.in_valA(val7to6);
    r1.in_ackA(ack7to6);
    r1.in_dataH(5to6);
    r1.in_valH(val5to6);
    r1.in_ackH(ack5to6);
    r1.in_dataT(2to6);
    r1.in_valT(val2to6);
    r1.in_ackT(ack2to6);
    r1.out_dataL(out_locals_data[5]);
    r1.out_valL(out_locals_val[5]);
    r1.out_ackL(out_locals_ack[5]);
    r1.out_dataA(6to5);
    r1.out_valA(val6to5);
    r1.out_ackA(ack6to5);
    r1.out_dataH(6to7);
    r1.out_valH(val6to7);
    r1.out_ackH(ack6to7);
    r1.out_dataT(6to2);
    r1.out_valT(val6to2);
    r1.out_ackT(ack6to2);

    roteador r7("r7");
    r1.in_dataL(locals_data[6]);
    r1.in_valL(locals_val[6]);
    r1.in_ackL(locals_ack[6]);
    r1.in_dataA(8to7);
    r1.in_valA(val8to7);
    r1.in_ackA(ack8to7);
    r1.in_dataH(6to7);
    r1.in_valH(val6to7);
    r1.in_ackH(ack6to7);
    r1.in_dataT(3to7);
    r1.in_valT(val3to7);
    r1.in_ackT(ack3to7);
    r1.out_dataL(out_locals_data[6]);
    r1.out_valL(out_locals_val[6]);
    r1.out_ackL(out_locals_ack[6]);
    r1.out_dataA(6to6);
    r1.out_valA(val6to6);
    r1.out_ackA(ack6to6);
    r1.out_dataH(7to8);
    r1.out_valH(val7to8);
    r1.out_ackH(ack7to8);
    r1.out_dataT(7to3);
    r1.out_valT(val7to3);
    r1.out_ackT(ack7to3);

    roteador r8("r8");
    r1.in_dataL(locals_data[7]);
    r1.in_valL(locals_val[7]);
    r1.in_ackL(locals_ack[7]);
    r1.in_dataA(1to8);
    r1.in_valA(val1to8);
    r1.in_ackA(ack1to8);
    r1.in_dataH(7to8);
    r1.in_valH(val7to8);
    r1.in_ackH(ack7to8);
    r1.in_dataT(4to8);
    r1.in_valT(val4to8);
    r1.in_ackT(ack4to8);
    r1.out_dataL(out_locals_data[7]);
    r1.out_valL(out_locals_val[7]);
    r1.out_ackL(out_locals_ack[7]);
    r1.out_dataA(8to7);
    r1.out_valA(val8to7);
    r1.out_ackA(ack8to7);
    r1.out_dataH(8to1);
    r1.out_valH(val8to1);
    r1.out_ackH(ack8to1);
    r1.out_dataT(4to4);
    r1.out_valT(val4to4);
    r1.out_ackT(ack4to4);
}